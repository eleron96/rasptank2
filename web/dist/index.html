<!DOCTYPE html>
<html class="dark" lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RC Rover Control</title>
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#101922">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined">
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            colors: {
              primary: '#1173d4',
              'background-dark': '#101922',
              'panel-dark': '#111a22',
              'panel-muted': '#233648',
              'panel-accent': '#324d67'
            },
            fontFamily: {
              display: ['Space Grotesk', 'sans-serif']
            },
            borderRadius: {
              DEFAULT: '0.25rem',
              lg: '0.5rem',
              xl: '0.75rem',
              full: '9999px'
            }
          }
        }
      };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/granim/2.0.0/granim.min.js" integrity="sha512-0dZ0pniS3pSke1Mt2rt7NmBGG99nmCaTKty+O+kO5OVwOB1p5MNDoAuCEi0aKBslZx2drXr/7EQo1leChX2NDw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
      :root {
        --sweep-position: -20%;
        --sweep-width: 18%;
        --eco-sweep-position: -40%;
        --eco-sweep-width: 45%;
      }
      .glass-panel {
        background-color: rgba(15, 23, 42, 0.75);
        backdrop-filter: blur(18px) saturate(140%);
        -webkit-backdrop-filter: blur(18px) saturate(140%);
        border-color: rgba(255, 255, 255, 0.08);
        box-shadow: 0 20px 45px rgba(0, 0, 0, 0.35);
      }
      .glass-panel-light {
        background-color: rgba(30, 41, 59, 0.5);
        backdrop-filter: blur(22px) saturate(140%);
        -webkit-backdrop-filter: blur(22px) saturate(140%);
        border-color: rgba(255, 255, 255, 0.07);
        box-shadow: 0 18px 32px rgba(0, 0, 0, 0.3);
      }
      body.eco-mode .glass-panel {
        background-color: rgba(12, 48, 28, 0.65);
        border-color: rgba(197, 255, 210, 0.25);
      }
      body.eco-mode .glass-panel-light {
        background-color: rgba(18, 66, 40, 0.5);
        border-color: rgba(182, 255, 201, 0.2);
      }
      .bg-stage-parallax {
        transform: translateZ(0);
      }
      body {
        font-family: "Space Grotesk", system-ui, sans-serif;
      }
      .bg-stage {
        position: fixed;
        inset: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
        overflow: hidden;
        transition: opacity 0.6s ease;
      }
      .bg-stage-eco {
        opacity: 0;
      }
      body.eco-mode .bg-stage-eco {
        opacity: 1;
      }
      body.eco-mode .bg-stage-dark {
        opacity: 0;
      }
      #bg-dark,
      #bg-eco {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
      }
      .bg-layer {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
      }
      .bg-stage-dark .sweep {
        pointer-events: none;
        mix-blend-mode: screen;
        opacity: 0.35;
        filter: blur(60px);
      }
      .sweep-dark-one {
        background: linear-gradient(25deg,
          rgba(255, 80, 180, 0) 0%,
          rgba(255, 80, 180, 0.1) calc(var(--sweep-position) - var(--sweep-width)),
          rgba(0, 128, 255, 0.55) var(--sweep-position),
          rgba(0, 255, 180, 0.35) calc(var(--sweep-position) + var(--sweep-width)),
          rgba(255, 80, 180, 0) 100%);
        animation: sweepX 18s linear infinite;
      }
      .sweep-dark-two {
        opacity: 0.25;
        background: linear-gradient(-30deg,
          rgba(255, 120, 0, 0) 0%,
          rgba(255, 120, 0, 0.12) calc(var(--sweep-position) - var(--sweep-width)),
          rgba(255, 200, 0, 0.45) var(--sweep-position),
          rgba(0, 128, 255, 0.35) calc(var(--sweep-position) + var(--sweep-width)),
          rgba(255, 120, 0, 0) 100%);
        animation: sweepX 22s linear infinite;
        animation-delay: -10s;
      }
      @keyframes sweepX {
        0% { --sweep-position: -20%; }
        100% { --sweep-position: 120%; }
      }
      .vignette-dark {
        pointer-events: none;
        background: radial-gradient(120% 120% at 50% 50%, rgba(0,0,0,0) 0%, rgba(0,0,0,0.25) 70%, rgba(0,0,0,0.6) 100%);
        mix-blend-mode: multiply;
      }
      .bg-stage-eco .sweep {
        pointer-events: none;
        mix-blend-mode: screen;
        opacity: 1;
        filter: blur(50px) saturate(200%) brightness(130%);
        animation: ecoBreathe 12s ease-in-out infinite;
      }
      .sweep-eco-one {
        background: linear-gradient(30deg,
          rgba(255,255,180,0.3) 0%,
          rgba(180,255,200,0.6) calc(var(--eco-sweep-position) - var(--eco-sweep-width)),
          rgba(70,240,130,1) var(--eco-sweep-position),
          rgba(0,200,255,1) calc(var(--eco-sweep-position) + var(--eco-sweep-width)),
          rgba(255,210,100,0.9) calc(var(--eco-sweep-position) + var(--eco-sweep-width) * 2),
          rgba(255,255,180,0.3) 100%);
        background-size: 200% 200%;
        animation: ecoWave 16s ease-in-out infinite;
      }
      .sweep-eco-two {
        opacity: 0.95;
        background: linear-gradient(-35deg,
          rgba(230,255,240,0.3) 0%,
          rgba(140,255,210,0.6) calc(var(--eco-sweep-position) - var(--eco-sweep-width)),
          rgba(50,220,140,1) var(--eco-sweep-position),
          rgba(0,180,255,1) calc(var(--eco-sweep-position) + var(--eco-sweep-width)),
          rgba(255,200,100,0.9) calc(var(--eco-sweep-position) + var(--eco-sweep-width) * 2),
          rgba(230,255,240,0.3) 100%);
        background-size: 200% 200%;
        animation: ecoWaveReverse 20s ease-in-out infinite;
      }
      @keyframes ecoWave {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }
      @keyframes ecoWaveReverse {
        0% { background-position: 100% 50%; }
        50% { background-position: 0% 50%; }
        100% { background-position: 100% 50%; }
      }
      @keyframes ecoBreathe {
        0%, 100% { filter: blur(50px) saturate(160%) brightness(115%) opacity(0.85); }
        50% { filter: blur(35px) saturate(240%) brightness(150%) opacity(1); }
      }
      .vignette-eco {
        pointer-events: none;
        background: radial-gradient(120% 120% at 50% 50%, rgba(255,255,255,0) 0%, rgba(255,255,255,0.4) 60%, rgba(160,210,180,0.55) 100%);
        mix-blend-mode: screen;
      }
      .material-symbols-outlined {
        font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
      }
      .action-toggle,
      .primary-button,
      .secondary-button,
      .pad-button,
      .arm-button {
        transition: transform 0.15s ease, background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      }
      .action-toggle {
        width: 100%;
        border-radius: 0.65rem;
        background-color: rgba(35, 54, 72, 0.8);
        border: 1px solid rgba(255, 255, 255, 0.08);
        padding: 0.6rem 0.85rem;
        font-size: 0.85rem;
        text-align: center;
        color: rgba(255, 255, 255, 0.75);
        font-weight: 500;
      }
      .action-toggle:hover,
      .action-toggle:focus-visible,
      .action-toggle.is-active {
        background-color: rgba(17, 115, 212, 0.9);
        border-color: rgba(17, 115, 212, 0.9);
        color: #fff;
        outline: none;
        transform: translateY(-1px);
      }
      .primary-button {
        background: linear-gradient(135deg, #1173d4, #0f5ca9);
        color: #fff;
        padding: 0.65rem 1rem;
        border-radius: 0.75rem;
        font-weight: 600;
        border: 1px solid rgba(255, 255, 255, 0.08);
        text-transform: uppercase;
        letter-spacing: 0.06em;
      }
      .primary-button:hover,
      .primary-button:focus-visible {
        background: linear-gradient(135deg, #1581eb, #0f5ca9);
        outline: none;
        transform: translateY(-1px);
      }
      .secondary-button {
        background-color: rgba(35, 54, 72, 0.7);
        color: rgba(255, 255, 255, 0.85);
        padding: 0.55rem 0.9rem;
        border-radius: 0.75rem;
        font-weight: 500;
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
.secondary-button:hover,
.secondary-button:focus-visible {
        background-color: rgba(17, 115, 212, 0.85);
        color: #fff;
        outline: none;
        transform: translateY(-1px);
}
.action-toggle:disabled,
.secondary-button:disabled,
.primary-button:disabled {
  opacity: 0.45;
  cursor: not-allowed;
  transform: none;
}
      .secondary-button.is-active {
        background-color: rgba(17, 115, 212, 0.9);
        border-color: rgba(17, 115, 212, 0.9);
        color: #fff;
      }
      .header-mode {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.35rem;
        padding: 0.45rem 0.85rem;
        border-radius: 9999px;
        border: 1px solid rgba(255, 255, 255, 0.08);
        background-color: rgba(35, 54, 72, 0.65);
        color: rgba(255, 255, 255, 0.75);
        font-size: 0.7rem;
        letter-spacing: 0.08em;
        font-weight: 600;
        text-transform: uppercase;
        transition: transform 0.15s ease, background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
      }
      .header-mode:hover,
      .header-mode:focus-visible {
        background-color: rgba(17, 115, 212, 0.85);
        color: #fff;
        border-color: rgba(17, 115, 212, 0.9);
        outline: none;
        transform: translateY(-1px);
      }
      .header-mode.is-active {
        background: linear-gradient(135deg, #1173d4, #0f5ca9);
        color: #fff;
        border-color: rgba(17, 115, 212, 0.9);
        box-shadow: 0 12px 25px rgba(17, 115, 212, 0.2);
      }
      .header-mode:disabled,
      .header-mode.is-disabled {
        opacity: 0.4;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }
      body.eco-mode,
      body.eco-mode .bg-background-dark {
        background-color: #08130c !important;
      }
      body.eco-mode header {
        background-color: rgba(9, 35, 21, 0.85) !important;
        border-color: rgba(60, 152, 96, 0.35) !important;
      }
      body.eco-mode .header-mode {
        background-color: rgba(18, 78, 44, 0.65);
      }
      .camera-frame {
        aspect-ratio: 4 / 3;
        width: 100%;
        height: 100%;
        min-height: 240px;
      }
      .camera-feed {
        object-fit: cover;
        background-color: #000;
        transition: object-fit 0.25s ease;
      }
      body.camera-hq .camera-feed {
        object-fit: contain;
      }
      .pad-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        height: 2.5rem;
        width: 2.5rem;
        border-radius: 0.65rem;
        background-color: rgba(50, 77, 103, 0.85);
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: rgba(255, 255, 255, 0.85);
        font-weight: 600;
        font-size: 0.9rem;
        user-select: none;
        -webkit-user-select: none;
      }
      .pad-button:hover,
      .pad-button.is-active {
        background-color: #1173d4;
        border-color: #1173d4;
        color: #fff;
      }
      .pad-button:focus-visible {
        outline: none;
        transform: translateY(-1px);
      }
      .slider-field {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        font-size: 0.85rem;
        color: rgba(255, 255, 255, 0.75);
        font-weight: 500;
      }
      .slider-field input[type="range"] {
        flex: 1;
      }
      .stat-card {
        background-color: rgba(35, 54, 72, 0.65);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 0.9rem;
        padding: 0.75rem 0.9rem;
      }
      .stat-title {
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: rgba(255, 255, 255, 0.65);
      }
      .stat-value {
        font-size: 1.05rem;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.92);
      }
      .axis-chip {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.3rem;
        border-radius: 0.65rem;
        background-color: rgba(17, 115, 212, 0.15);
        color: rgba(255, 255, 255, 0.85);
        padding: 0.35rem 0.55rem;
      }
      .arm-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 2rem;
        height: 2rem;
        border-radius: 0.55rem;
        background-color: rgba(50, 77, 103, 0.85);
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: rgba(255, 255, 255, 0.85);
        user-select: none;
        -webkit-user-select: none;
      }
      .arm-button:hover,
      .arm-button.is-active {
        background-color: #1173d4;
        border-color: #1173d4;
        color: #fff;
      }
      .arm-cluster[data-small="true"] .arm-button {
        width: 1.75rem;
        height: 1.75rem;
      }
      .scrollbar-thin::-webkit-scrollbar {
        height: 6px;
        width: 6px;
      }
      .scrollbar-thin::-webkit-scrollbar-thumb {
        background-color: rgba(148, 163, 184, 0.35);
        border-radius: 9999px;
      }
      .scrollbar-thin::-webkit-scrollbar-track {
        background-color: transparent;
      }
      .hud-badge {
        position: absolute;
        top: 0.75rem;
        left: 0.75rem;
        padding: 0.3rem 0.85rem;
        border-radius: 9999px;
        background-color: rgba(0, 0, 0, 0.65);
        color: rgba(255, 255, 255, 0.95);
        font-size: 0.75rem;
        font-weight: 600;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        pointer-events: none;
      }
      .hud-crosshair {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 20px;
        height: 20px;
        margin-left: -10px;
        margin-top: -10px;
        border-radius: 9999px;
        border: 1px solid rgba(255, 255, 255, 0.55);
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.45);
        pointer-events: none;
      }
      .hud-crosshair::before,
      .hud-crosshair::after {
        content: "";
        position: absolute;
        background-color: rgba(255, 255, 255, 0.6);
      }
      .hud-crosshair::before {
        width: 1px;
        height: 14px;
        top: 3px;
        left: 50%;
        transform: translateX(-50%);
      }
      .hud-crosshair::after {
        height: 1px;
        width: 14px;
        left: 3px;
        top: 50%;
        transform: translateY(-50%);
      }
    </style>
  </head>
  <body class="bg-background-dark text-white min-h-screen">
    <div class="bg-stage bg-stage-dark bg-stage-parallax" aria-hidden="true">
      <canvas id="bg-dark"></canvas>
      <div class="bg-layer sweep-dark-one"></div>
      <div class="bg-layer sweep-dark-two"></div>
      <div class="bg-layer vignette-dark"></div>
    </div>
    <div class="bg-stage bg-stage-eco bg-stage-parallax" aria-hidden="true">
      <canvas id="bg-eco"></canvas>
      <div class="bg-layer sweep-eco-one"></div>
      <div class="bg-layer sweep-eco-two"></div>
      <div class="bg-layer vignette-eco"></div>
    </div>
    <div class="flex flex-col min-h-screen">
      <header class="flex items-center justify-between gap-6 border-b border-panel-muted/70 px-8 py-4 bg-background-dark">
        <div class="flex items-center gap-4">
          <div class="size-9 rounded-full bg-primary/20 text-primary grid place-items-center">
            <span class="material-symbols-outlined text-3xl">precision_manufacturing</span>
          </div>
          <div>
            <h1 class="text-xl font-bold tracking-tight">RC Rover</h1>
            <p class="text-sm text-white/60">Adeept Robot HAT Controller</p>
          </div>
        </div>
        <div class="flex items-center gap-6 flex-wrap justify-end">
          <div class="flex items-center flex-wrap gap-2">
            <button type="button" class="mode-toggle header-mode" data-mode="ACTIVE" data-command="modeActive" data-label-active="Active" data-label-standby="Standby (auto)">Active</button>
            <button type="button" class="mode-toggle header-mode" data-mode="ECO" data-command="modeEco">Eco</button>
            <button type="button" id="camera-hq-toggle" class="header-mode" title="1920×1080 @ 30fps (Active only)">HD+</button>
          </div>
          <div class="flex items-center gap-2 text-sm">
            <span class="material-symbols-outlined text-green-400" id="connection-indicator">wifi_off</span>
            <span id="connection-label">Disconnected</span>
          </div>
          <button id="reconnect-button" class="hidden h-9 rounded-full border border-white/20 px-4 text-sm font-medium text-white/80 hover:border-primary hover:text-primary transition">Reconnect</button>
        </div>
      </header>

      <main class="flex flex-1 overflow-hidden">
        <div class="grid grid-cols-12 gap-5 p-8 flex-1 overflow-auto scrollbar-thin lg:min-h-[700px]">
          <section class="order-1 col-span-12 lg:order-1 lg:col-span-6">
            <div class="camera-frame relative rounded-xl overflow-hidden bg-black/70 border border-white/5 shadow-xl h-[60vh]">
              <div id="distance-overlay" class="hud-badge">Distance - -- cm</div>
              <div class="hud-crosshair" aria-hidden="true"></div>
              <img id="video-stream" src="" alt="Rover camera feed" class="camera-feed absolute inset-0 w-full h-full bg-black select-none pointer-events-none">
            </div>
          </section>

          <section class="order-2 col-span-12 lg:order-1 lg:col-span-3">
            <div class="glass-panel border rounded-xl p-5 flex flex-col gap-5 shadow-lg">
              <h2 class="text-lg font-semibold">Controls</h2>
              <div class="glass-panel-light border rounded-xl p-4 flex flex-col gap-4">
                <p class="text-sm text-white/70 font-medium text-center tracking-wide uppercase">Rover Movement</p>
                <div class="grid grid-cols-3 gap-2 w-36 mx-auto">
                  <div></div>
                  <button class="pad-button" data-command="forward" data-stop="DS" data-keys="KeyW,ArrowUp">W</button>
                  <div></div>
                  <button class="pad-button" data-command="left" data-stop="TS" data-keys="KeyA,ArrowLeft">A</button>
                  <button class="pad-button" data-command="backward" data-stop="DS" data-keys="KeyS,ArrowDown">S</button>
                  <button class="pad-button" data-command="right" data-stop="TS" data-keys="KeyD,ArrowRight">D</button>
                </div>
                <div class="flex flex-col gap-2">
                  <div class="flex items-center justify-between gap-4">
                    <span class="text-sm text-white/70 uppercase tracking-wide">Speed</span>
                    <span id="speed-value" class="text-sm font-semibold text-white/80">100</span>
                  </div>
                  <input id="speed-slider" type="range" min="10" max="200" value="100" class="w-full accent-primary">
                </div>
              </div>
              <div class="glass-panel-light border rounded-xl p-4 space-y-4">
                <div class="flex items-center justify-between">
                  <p class="text-sm text-white/70 font-medium text-center tracking-wide uppercase flex-1 text-left">Arm &amp; Gripper</p>
                  <button id="arm-settings-button" class="size-7 grid place-items-center rounded-full border border-white/15 text-white/70 hover:border-primary hover:text-primary transition" aria-label="Arm step settings">
                    <span class="material-symbols-outlined text-base">settings</span>
                  </button>
                </div>
                <div id="arm-settings-panel" class="hidden rounded-lg border border-white/10 bg-panel-muted/40 p-3 space-y-3 text-xs text-white/70">
                  <p class="text-[11px] text-white/50 leading-snug">Adjust how far the shoulder, wrist, rotate, and gripper servos travel per command. Values persist across reboots.</p>
                  <div class="space-y-2">
                    <label class="flex items-center justify-between gap-4">
                      <span>Shoulder step</span>
                      <div class="flex items-center gap-2 w-36">
                        <input id="arm-step-shoulder" type="range" min="1" max="10" value="1" class="flex-1 accent-primary">
                        <span id="arm-step-shoulder-value" class="w-6 text-right font-semibold text-white/90">1</span>
                      </div>
                    </label>
                    <label class="flex items-center justify-between gap-4">
                      <span>Wrist step</span>
                      <div class="flex items-center gap-2 w-36">
                        <input id="arm-step-wrist" type="range" min="1" max="10" value="1" class="flex-1 accent-primary">
                        <span id="arm-step-wrist-value" class="w-6 text-right font-semibold text-white/90">1</span>
                      </div>
                    </label>
                    <label class="flex items-center justify-between gap-4">
                      <span>Rotate step</span>
                      <div class="flex items-center gap-2 w-36">
                        <input id="arm-step-rotate" type="range" min="1" max="10" value="1" class="flex-1 accent-primary">
                        <span id="arm-step-rotate-value" class="w-6 text-right font-semibold text-white/90">1</span>
                      </div>
                    </label>
                    <label class="flex items-center justify-between gap-4">
                      <span>Gripper step</span>
                      <div class="flex items-center gap-2 w-36">
                        <input id="arm-step-gripper" type="range" min="1" max="10" value="1" class="flex-1 accent-primary">
                        <span id="arm-step-gripper-value" class="w-6 text-right font-semibold text-white/90">1</span>
                      </div>
                    </label>
                  </div>
                  <div class="flex items-center justify-between gap-3 pt-1">
                    <button id="arm-settings-save" class="px-3 py-1.5 rounded-lg bg-primary/20 text-white/90 text-xs font-semibold hover:bg-primary/30 transition">Save</button>
                    <p id="arm-settings-status" class="text-[11px] text-white/60 text-right flex-1"></p>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-2 text-xs">
                  <div class="arm-cluster" data-label="Gripper" data-command="grab" data-stop="GLstop" data-command-alt="loose"></div>
                  <div class="arm-cluster" data-label="Shoulder" data-command="armUp" data-stop="armStop" data-command-alt="armDown"></div>
                  <div class="arm-cluster" data-label="Wrist" data-command="handUp" data-stop="handStop" data-command-alt="handDown"></div>
                  <div class="arm-cluster" data-label="Rotate" data-command="lookleft" data-stop="LRstop" data-command-alt="lookright" data-icons="arrow_back,arrow_forward"></div>
                  <div class="arm-cluster" data-label="Camera" data-command="up" data-stop="UDstop" data-command-alt="down"></div>
                </div>
              </div>
              <div class="glass-panel-light border rounded-xl p-4 space-y-4">
                <p class="text-sm text-white/70 font-medium text-center tracking-wide uppercase">Lighting</p>
                <div class="grid grid-cols-1 gap-2">
                  <button class="action-toggle" data-action="ledOn" data-off="ledOff">Headlight LED</button>
                  <button class="action-toggle" data-action="wsStripOn" data-off="wsStripOff" data-light="strip">LED Strip</button>
                </div>
              </div>
            </div>
          </section>

          <section class="order-3 col-span-12 lg:order-1 lg:col-span-3">
            <div class="glass-panel border rounded-xl p-5 flex flex-col gap-4 shadow-lg">
              <h2 class="text-lg font-semibold">Rover Stats</h2>
              <div class="grid grid-cols-1 gap-4">
                <div class="glass-panel-light border rounded-xl p-4 space-y-3">
                  <div class="flex items-center justify-between">
                    <div class="flex items-center gap-2">
                      <p class="stat-title">Battery</p>
                      <button id="battery-settings-button" class="size-7 grid place-items-center rounded-full border border-white/15 text-white/70 hover:border-primary hover:text-primary transition" aria-label="Battery calibration">
                        <span class="material-symbols-outlined text-base">settings</span>
                      </button>
                    </div>
                    <p class="stat-value"><span id="battery-percent">--</span>%</p>
                  </div>
                  <div id="battery-settings-panel" class="hidden rounded-lg border border-white/10 bg-panel-muted/40 p-3 space-y-3 text-xs text-white/70">
                    <p class="text-[11px] text-white/50 leading-snug">Введите измеренное мультиметром напряжение батареи, чтобы скорректировать показания индикатора.</p>
                    <label class="flex items-center justify-between gap-4">
                      <span>Measured voltage (V)</span>
                      <input id="battery-cal-input" type="number" min="0" step="0.01" class="h-9 w-24 rounded border border-white/15 bg-panel-accent px-2 text-sm">
                    </label>
                    <div class="flex items-center justify-between gap-3">
                      <button id="battery-cal-run" class="secondary-button px-3 py-1 text-xs">Calibrate</button>
                      <p id="battery-cal-status" class="text-[11px] text-white/60 text-right flex-1"></p>
                    </div>
                  </div>
                  <div class="h-12">
                    <canvas id="battery-chart"></canvas>
                  </div>
                </div>
                <div class="glass-panel-light border rounded-xl p-4">
                  <div class="flex justify-between items-center mb-2">
                    <p class="stat-title">CPU Load</p>
                    <p class="stat-value"><span id="cpu-usage">--</span>%</p>
                  </div>
                  <div class="h-12">
                    <canvas id="cpu-chart"></canvas>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div class="glass-panel-light border rounded-xl p-4">
                    <p class="stat-title">CPU Temp</p>
                    <p class="stat-value"><span id="cpu-temp">--</span>°C</p>
                  </div>
                  <div class="glass-panel-light border rounded-xl p-4">
                    <p class="stat-title">RAM Usage</p>
                    <p class="stat-value"><span id="ram-usage">--</span>%</p>
                  </div>
                  <div class="glass-panel-light border rounded-xl p-4">
                    <p class="stat-title">Voltage</p>
                    <p class="stat-value"><span id="battery-voltage">--</span>V</p>
                  </div>
                  <div class="glass-panel-light border rounded-xl p-4">
                    <p class="stat-title">Connection Quality</p>
                    <p class="stat-value"><span id="connection-quality" class="text-white/70">--</span></p>
                  </div>
                </div>
                <div class="glass-panel-light border rounded-xl p-4">
                  <div class="flex justify-between items-center mb-2">
                    <p class="stat-title">Distance Monitor</p>
                    <button id="distance-settings-button" class="size-7 grid place-items-center rounded-full border border-white/15 text-white/70 hover:border-primary hover:text-primary transition">
                      <span class="material-symbols-outlined text-base">settings</span>
                    </button>
                  </div>
                  <p class="text-2xl font-semibold text-white/90">Distance: <span id="distance-status-value">--</span> cm</p>
                  <p class="text-xs text-white/60 mt-1">Status: <span id="distance-status-label">Disabled</span></p>
                  <div id="distance-settings-panel" class="hidden mt-3 rounded-lg border border-white/10 bg-panel-muted/40 p-3 space-y-2 text-xs text-white/70">
                    <label class="flex items-center justify-between gap-3">
                      <span>Enable ultrasonic sensor</span>
                      <input id="distance-toggle" type="checkbox" class="h-4 w-7 accent-primary">
                    </label>
                    <p class="text-[11px] text-white/50 leading-snug">When enabled, readings pause automatically after 60s of no movement.</p>
                  </div>
                </div>
                <div class="grid grid-cols-2 gap-3">
                  <div class="glass-panel-light border rounded-xl p-4 space-y-2">
                    <p class="text-sm font-medium uppercase tracking-wide text-white/60">Gyroscope (°/s)</p>
                    <div class="grid grid-cols-3 gap-2 text-xs">
                      <div class="axis-chip">X <span id="gyro-x">--</span></div>
                      <div class="axis-chip">Y <span id="gyro-y">--</span></div>
                      <div class="axis-chip">Z <span id="gyro-z">--</span></div>
                    </div>
                  </div>
                  <div class="glass-panel-light border rounded-xl p-4 space-y-2">
                    <p class="text-sm font-medium uppercase tracking-wide text-white/60">Accelerometer (g)</p>
                    <div class="grid grid-cols-3 gap-2 text-xs">
                      <div class="axis-chip">X <span id="accel-x">--</span></div>
                      <div class="axis-chip">Y <span id="accel-y">--</span></div>
                      <div class="axis-chip">Z <span id="accel-z">--</span></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <section class="order-4 col-span-12 lg:order-2 lg:col-span-12">
            <div class="glass-panel border rounded-xl p-6 shadow-lg flex flex-col gap-6">
              <div class="flex items-center justify-between">
                <h2 class="text-lg font-semibold">Settings</h2>
              </div>

                <div class="grid lg:grid-cols-3 gap-5">
                  <div class="space-y-5">
                    <div class="space-y-3">
                    <p class="text-white/70 text-sm font-medium uppercase tracking-wide">Actions</p>
                    <div class="glass-panel-light border rounded-xl p-4 grid grid-cols-1 gap-2">
                      <button class="action-toggle" data-action="motionGet" data-off="stopCV">Motion Get</button>
                      <button class="action-toggle" data-action="automatic" data-off="automaticOff">Auto Matic</button>
                      <button class="action-toggle" data-action="trackLine" data-off="trackLineOff">Track Line</button>
                    </div>
                  </div>
                </div>

                <div class="lg:col-span-2 space-y-5">
                  <div class="grid lg:grid-cols-2 gap-5">
                    <div class="space-y-3">
                      <p class="text-white/70 text-sm font-medium uppercase tracking-wide">FC Control</p>
                      <div class="glass-panel-light border rounded-lg p-4 space-y-3">
                        <button id="fc-toggle" class="primary-button w-full">Start</button>
                        <label class="flex items-center justify-between gap-4 text-sm text-white/70">
                          <span>Color</span>
                          <input id="fc-color" type="color" class="h-9 w-16 rounded border border-white/10 bg-panel-accent" value="#1173d4">
                        </label>
                      </div>
                    </div>

                    <div class="space-y-3">
                      <p class="text-white/70 text-sm font-medium uppercase tracking-wide">CVFL Control</p>
                      <div class="glass-panel-light border rounded-lg p-4 space-y-4">
                        <button id="cvfl-toggle" class="primary-button w-full">Start</button>
                        <div class="space-y-3">
                          <label class="slider-field">
                            <span>L1</span>
                            <input id="cvfl-l1" type="range" min="0" max="480" value="380">
                          </label>
                          <label class="slider-field">
                            <span>L2</span>
                            <input id="cvfl-l2" type="range" min="0" max="480" value="440">
                          </label>
                          <label class="slider-field">
                            <span>Speed</span>
                            <input id="cvfl-sp" type="range" min="10" max="200" value="120">
                          </label>
                        </div>
                        <div class="flex items-center justify-between text-sm text-white/70">
                          <span>Color inversion</span>
                          <button id="cvfl-color-toggle" class="secondary-button px-3 py-1 text-xs">Toggle</button>
                        </div>
                        <p id="cvfl-color-label" class="text-xs text-white/60 text-center uppercase tracking-wide">#FFFFFF</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>
      </main>
    </div>

    <template id="arm-cluster-template">
      <div class="bg-panel-muted/40 border border-white/5 rounded-lg p-3 flex flex-col items-center gap-2">
        <p class="text-[11px] uppercase tracking-wide text-white/60 cluster-label">Label</p>
        <div class="flex items-center gap-1">
          <button class="arm-button" data-role="primary">
            <span class="material-symbols-outlined text-base" data-icon="primary">arrow_upward</span>
          </button>
          <button class="arm-button" data-role="secondary">
            <span class="material-symbols-outlined text-base" data-icon="secondary">arrow_downward</span>
          </button>
        </div>
      </div>
    </template>

    <script src="/js/rover-ui.js" defer></script>
  </body>
</html>
